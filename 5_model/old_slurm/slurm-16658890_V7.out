Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d (Conv2D)             (None, 1, 143, 3)         84        
                                                                 
 dropout (Dropout)           (None, 1, 143, 3)         0         
                                                                 
 lambda (Lambda)             (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_1 (Dropout)         (None, 143, 32)           0         
                                                                 
 self_attention (SelfAttenti  ((None, 512),            1536      
 on)                          (None, 16, 143))                   
                                                                 
 dense (Dense)               (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 30
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 43s  6/127 [>.............................] - ETA: 1s  14/127 [==>...........................] - ETA: 0s 21/127 [===>..........................] - ETA: 0s 28/127 [=====>........................] - ETA: 0s 35/127 [=======>......................] - ETA: 0s 42/127 [========>.....................] - ETA: 0s 49/127 [==========>...................] - ETA: 0s 56/127 [============>.................] - ETA: 0s 64/127 [==============>...............] - ETA: 0s 71/127 [===============>..............] - ETA: 0s 78/127 [=================>............] - ETA: 0s 86/127 [===================>..........] - ETA: 0s 93/127 [====================>.........] - ETA: 0s100/127 [======================>.......] - ETA: 0s107/127 [========================>.....] - ETA: 0s114/127 [=========================>....] - ETA: 0s121/127 [===========================>..] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 0
              precision    recall  f1-score   support

           0       0.87      0.82      0.85      1386
           1       0.65      0.74      0.69       635

    accuracy                           0.79      2021
   macro avg       0.76      0.78      0.77      2021
weighted avg       0.80      0.79      0.80      2021

auc[0.7942] Recall[0.7800] F1[0.7693] at fold[0]
______________________________________________________
Model: "model_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_2 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_1 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_2 (Dropout)         (None, 1, 143, 3)         0         
                                                                 
 lambda_1 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_3 (Dropout)         (None, 143, 32)           0         
                                                                 
 self_attention_1 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_1 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 20
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 41s  5/127 [>.............................] - ETA: 1s  12/127 [=>............................] - ETA: 1s 19/127 [===>..........................] - ETA: 0s 26/127 [=====>........................] - ETA: 0s 33/127 [======>.......................] - ETA: 0s 40/127 [========>.....................] - ETA: 0s 47/127 [==========>...................] - ETA: 0s 54/127 [===========>..................] - ETA: 0s 61/127 [=============>................] - ETA: 0s 68/127 [===============>..............] - ETA: 0s 75/127 [================>.............] - ETA: 0s 82/127 [==================>...........] - ETA: 0s 89/127 [====================>.........] - ETA: 0s 96/127 [=====================>........] - ETA: 0s103/127 [=======================>......] - ETA: 0s110/127 [========================>.....] - ETA: 0s117/127 [==========================>...] - ETA: 0s124/127 [============================>.] - ETA: 0s127/127 [==============================] - 1s 8ms/step
fold 1
              precision    recall  f1-score   support

           0       0.88      0.77      0.82      1386
           1       0.60      0.76      0.67       635

    accuracy                           0.77      2021
   macro avg       0.74      0.77      0.75      2021
weighted avg       0.79      0.77      0.77      2021

auc[0.7660] Recall[0.7654] F1[0.7451] at fold[1]
______________________________________________________
Model: "model_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_3 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_2 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_4 (Dropout)         (None, 1, 143, 3)         0         
                                                                 
 lambda_2 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_5 (Dropout)         (None, 143, 32)           0         
                                                                 
 self_attention_2 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_2 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 36
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 41s  5/127 [>.............................] - ETA: 1s  12/127 [=>............................] - ETA: 1s 19/127 [===>..........................] - ETA: 0s 26/127 [=====>........................] - ETA: 0s 33/127 [======>.......................] - ETA: 0s 40/127 [========>.....................] - ETA: 0s 47/127 [==========>...................] - ETA: 0s 54/127 [===========>..................] - ETA: 0s 61/127 [=============>................] - ETA: 0s 68/127 [===============>..............] - ETA: 0s 75/127 [================>.............] - ETA: 0s 83/127 [==================>...........] - ETA: 0s 90/127 [====================>.........] - ETA: 0s 97/127 [=====================>........] - ETA: 0s104/127 [=======================>......] - ETA: 0s111/127 [=========================>....] - ETA: 0s118/127 [==========================>...] - ETA: 0s125/127 [============================>.] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 2
              precision    recall  f1-score   support

           0       0.86      0.85      0.85      1386
           1       0.68      0.69      0.68       635

    accuracy                           0.80      2021
   macro avg       0.77      0.77      0.77      2021
weighted avg       0.80      0.80      0.80      2021

auc[0.8001] Recall[0.7706] F1[0.7692] at fold[2]
______________________________________________________
Model: "model_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_4 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_3 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_6 (Dropout)         (None, 1, 143, 3)         0         
                                                                 
 lambda_3 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_7 (Dropout)         (None, 143, 32)           0         
                                                                 
 self_attention_3 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_3 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 49
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 3:04  2/127 [..............................] - ETA: 7s    9/127 [=>............................] - ETA: 1s 16/127 [==>...........................] - ETA: 1s 23/127 [====>.........................] - ETA: 1s 30/127 [======>.......................] - ETA: 0s 37/127 [=======>......................] - ETA: 0s 44/127 [=========>....................] - ETA: 0s 51/127 [===========>..................] - ETA: 0s 58/127 [============>.................] - ETA: 0s 65/127 [==============>...............] - ETA: 0s 72/127 [================>.............] - ETA: 0s 79/127 [=================>............] - ETA: 0s 86/127 [===================>..........] - ETA: 0s 93/127 [====================>.........] - ETA: 0s100/127 [======================>.......] - ETA: 0s107/127 [========================>.....] - ETA: 0s114/127 [=========================>....] - ETA: 0s121/127 [===========================>..] - ETA: 0s127/127 [==============================] - 2s 8ms/step
fold 3
              precision    recall  f1-score   support

           0       0.80      0.90      0.85      1386
           1       0.69      0.51      0.59       635

    accuracy                           0.77      2021
   macro avg       0.75      0.70      0.72      2021
weighted avg       0.77      0.77      0.76      2021

auc[0.7749] Recall[0.7032] F1[0.7163] at fold[3]
______________________________________________________
Model: "model_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_5 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_4 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_8 (Dropout)         (None, 1, 143, 3)         0         
                                                                 
 lambda_4 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_9 (Dropout)         (None, 143, 32)           0         
                                                                 
 self_attention_4 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_4 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 26
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 41s  8/127 [>.............................] - ETA: 0s  15/127 [==>...........................] - ETA: 0s 22/127 [====>.........................] - ETA: 0s 29/127 [=====>........................] - ETA: 0s 36/127 [=======>......................] - ETA: 0s 43/127 [=========>....................] - ETA: 0s 50/127 [==========>...................] - ETA: 0s 57/127 [============>.................] - ETA: 0s 64/127 [==============>...............] - ETA: 0s 71/127 [===============>..............] - ETA: 0s 78/127 [=================>............] - ETA: 0s 85/127 [===================>..........] - ETA: 0s 92/127 [====================>.........] - ETA: 0s 99/127 [======================>.......] - ETA: 0s106/127 [========================>.....] - ETA: 0s114/127 [=========================>....] - ETA: 0s121/127 [===========================>..] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 4
              precision    recall  f1-score   support

           0       0.81      0.88      0.85      1386
           1       0.68      0.55      0.61       635

    accuracy                           0.78      2021
   macro avg       0.75      0.72      0.73      2021
weighted avg       0.77      0.78      0.77      2021

auc[0.7793] Recall[0.7179] F1[0.7287] at fold[4]
______________________________________________________
Model: "model_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_6 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_5 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_10 (Dropout)        (None, 1, 143, 3)         0         
                                                                 
 lambda_5 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_11 (Dropout)        (None, 143, 32)           0         
                                                                 
 self_attention_5 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_5 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 47
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 45s  7/127 [>.............................] - ETA: 1s  14/127 [==>...........................] - ETA: 0s 21/127 [===>..........................] - ETA: 0s 28/127 [=====>........................] - ETA: 0s 35/127 [=======>......................] - ETA: 0s 42/127 [========>.....................] - ETA: 0s 49/127 [==========>...................] - ETA: 0s 56/127 [============>.................] - ETA: 0s 63/127 [=============>................] - ETA: 0s 70/127 [===============>..............] - ETA: 0s 77/127 [=================>............] - ETA: 0s 84/127 [==================>...........] - ETA: 0s 91/127 [====================>.........] - ETA: 0s 98/127 [======================>.......] - ETA: 0s105/127 [=======================>......] - ETA: 0s112/127 [=========================>....] - ETA: 0s119/127 [===========================>..] - ETA: 0s126/127 [============================>.] - ETA: 0s127/127 [==============================] - 1s 8ms/step
fold 5
              precision    recall  f1-score   support

           0       0.90      0.77      0.83      1386
           1       0.62      0.82      0.70       634

    accuracy                           0.78      2020
   macro avg       0.76      0.79      0.77      2020
weighted avg       0.81      0.78      0.79      2020

auc[0.7832] Recall[0.7919] F1[0.7659] at fold[5]
______________________________________________________
Model: "model_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_7 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_6 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_12 (Dropout)        (None, 1, 143, 3)         0         
                                                                 
 lambda_6 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_13 (Dropout)        (None, 143, 32)           0         
                                                                 
 self_attention_6 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_6 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
/lustre06/project/6003138/rezvank/5_model/baseline.py:161: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=[8,6])
None
Early stopping epoch: 47
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 49s  8/127 [>.............................] - ETA: 0s  15/127 [==>...........................] - ETA: 0s 22/127 [====>.........................] - ETA: 0s 29/127 [=====>........................] - ETA: 0s 36/127 [=======>......................] - ETA: 0s 43/127 [=========>....................] - ETA: 0s 50/127 [==========>...................] - ETA: 0s 57/127 [============>.................] - ETA: 0s 64/127 [==============>...............] - ETA: 0s 71/127 [===============>..............] - ETA: 0s 78/127 [=================>............] - ETA: 0s 85/127 [===================>..........] - ETA: 0s 92/127 [====================>.........] - ETA: 0s 99/127 [======================>.......] - ETA: 0s106/127 [========================>.....] - ETA: 0s113/127 [=========================>....] - ETA: 0s120/127 [===========================>..] - ETA: 0s127/127 [==============================] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 6
              precision    recall  f1-score   support

           0       0.84      0.85      0.84      1386
           1       0.66      0.64      0.65       634

    accuracy                           0.78      2020
   macro avg       0.75      0.74      0.75      2020
weighted avg       0.78      0.78      0.78      2020

auc[0.7842] Recall[0.7443] F1[0.7468] at fold[6]
______________________________________________________
Model: "model_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_8 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_7 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_14 (Dropout)        (None, 1, 143, 3)         0         
                                                                 
 lambda_7 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_15 (Dropout)        (None, 143, 32)           0         
                                                                 
 self_attention_7 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_7 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 23
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 52s  8/127 [>.............................] - ETA: 0s  15/127 [==>...........................] - ETA: 0s 22/127 [====>.........................] - ETA: 0s 29/127 [=====>........................] - ETA: 0s 36/127 [=======>......................] - ETA: 0s 43/127 [=========>....................] - ETA: 0s 50/127 [==========>...................] - ETA: 0s 57/127 [============>.................] - ETA: 0s 64/127 [==============>...............] - ETA: 0s 71/127 [===============>..............] - ETA: 0s 78/127 [=================>............] - ETA: 0s 85/127 [===================>..........] - ETA: 0s 92/127 [====================>.........] - ETA: 0s 99/127 [======================>.......] - ETA: 0s106/127 [========================>.....] - ETA: 0s113/127 [=========================>....] - ETA: 0s120/127 [===========================>..] - ETA: 0s127/127 [==============================] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 7
              precision    recall  f1-score   support

           0       0.90      0.79      0.84      1386
           1       0.64      0.80      0.71       634

    accuracy                           0.79      2020
   macro avg       0.77      0.80      0.77      2020
weighted avg       0.82      0.79      0.80      2020

auc[0.7936] Recall[0.7961] F1[0.7747] at fold[7]
______________________________________________________
Model: "model_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_9 (InputLayer)        [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_8 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_16 (Dropout)        (None, 1, 143, 3)         0         
                                                                 
 lambda_8 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_17 (Dropout)        (None, 143, 32)           0         
                                                                 
 self_attention_8 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_8 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 40
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 49s  8/127 [>.............................] - ETA: 0s  15/127 [==>...........................] - ETA: 0s 22/127 [====>.........................] - ETA: 0s 29/127 [=====>........................] - ETA: 0s 36/127 [=======>......................] - ETA: 0s 44/127 [=========>....................] - ETA: 0s 51/127 [===========>..................] - ETA: 0s 58/127 [============>.................] - ETA: 0s 65/127 [==============>...............] - ETA: 0s 72/127 [================>.............] - ETA: 0s 81/127 [==================>...........] - ETA: 0s 90/127 [====================>.........] - ETA: 0s 98/127 [======================>.......] - ETA: 0s106/127 [========================>.....] - ETA: 0s115/127 [==========================>...] - ETA: 0s124/127 [============================>.] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 8
              precision    recall  f1-score   support

           0       0.86      0.82      0.84      1386
           1       0.64      0.72      0.68       634

    accuracy                           0.79      2020
   macro avg       0.75      0.77      0.76      2020
weighted avg       0.80      0.79      0.79      2020

auc[0.7871] Recall[0.7691] F1[0.7603] at fold[8]
______________________________________________________
Model: "model_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_10 (InputLayer)       [(None, 3, 145, 3)]       0         
                                                                 
 conv2d_9 (Conv2D)           (None, 1, 143, 3)         84        
                                                                 
 dropout_18 (Dropout)        (None, 1, 143, 3)         0         
                                                                 
 lambda_9 (Lambda)           (None, 143, 3)            0         
                                                                 
 lstm (LSTM)                 [(None, 143, 32),         4608      
                              (None, 32),                        
                              (None, 32)]                        
                                                                 
 dropout_19 (Dropout)        (None, 143, 32)           0         
                                                                 
 self_attention_9 (SelfAtten  ((None, 512),            1536      
 tion)                        (None, 16, 143))                   
                                                                 
 dense_9 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 7,254
Trainable params: 7,254
Non-trainable params: 0
_________________________________________________________________
None
Early stopping epoch: 29
******Evaluating TEST set*********
  1/127 [..............................] - ETA: 45s  8/127 [>.............................] - ETA: 0s  15/127 [==>...........................] - ETA: 0s 22/127 [====>.........................] - ETA: 0s 29/127 [=====>........................] - ETA: 0s 36/127 [=======>......................] - ETA: 0s 43/127 [=========>....................] - ETA: 0s 50/127 [==========>...................] - ETA: 0s 57/127 [============>.................] - ETA: 0s 64/127 [==============>...............] - ETA: 0s 71/127 [===============>..............] - ETA: 0s 78/127 [=================>............] - ETA: 0s 85/127 [===================>..........] - ETA: 0s 92/127 [====================>.........] - ETA: 0s 99/127 [======================>.......] - ETA: 0s106/127 [========================>.....] - ETA: 0s113/127 [=========================>....] - ETA: 0s120/127 [===========================>..] - ETA: 0s127/127 [==============================] - ETA: 0s127/127 [==============================] - 1s 7ms/step
fold 9
              precision    recall  f1-score   support

           0       0.87      0.82      0.85      1386
           1       0.65      0.74      0.69       634

    accuracy                           0.80      2020
   macro avg       0.76      0.78      0.77      2020
weighted avg       0.80      0.80      0.80      2020

auc[0.7950] Recall[0.7792] F1[0.7695] at fold[9]
______________________________________________________
Mean Accuracy[0.7857] IC [0.7797, 0.7918]
Mean Recall[0.7618] IC [0.7439, 0.7796]
Mean F1[0.7546] IC [0.7432, 0.7660]
